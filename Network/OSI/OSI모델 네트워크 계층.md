# 네트워크 계층
**tags** : #network #OSI

- 서로 다른 네트워크 간의 연결
- 데이터 링크 계층에서 이더넷 규칙을 기반으로 데이터의 전송 담당
    - 같은 네트워크에 있는 컴퓨터로는 데이터를 전송할 수 있지만, 다른 네트워크로는 데이터를 전송할 수 없음
- 라우터 : 다른 네트워크로 데이터를 전송할 때 필요
- IP주소 : 네트워크를 식별할 때 사용, 어떤 네트워크의 어떤 컴퓨터인지 구분할 대 사용
- 라우팅 : 목적지뿐만 아니라 어떤 경로로 보내는지 결정

## IP(Internet Protocol)
- 네트워크 계층에서 캡슐화할 때 IP헤더를 붙임
- IP해더는 다으모과 같은 요소로 구성됨
    - 버전, 헤더 길이, 서비스 유형, 전체 패킷 길이, ID, 조각 상태, 조각의 위치, TTl, 헤더 체크섬, **출발지 IP 주소**, **목적지 IP 주소**
- IP패킷 : IP 프로토콜을 사용하여 캡슐화할 때 데이터에 IP헤더가 추가된 것

#### IP주소의 구조
- IP주소는 ISP(인터넷 서비스 제공자)에게 받을 수 있음
- IP버전으로 IPv4, IPv6가 있음
- IP주소에는 공인 IP 주소, 사설 IP 주소가 있음
    - 인터넷에 직접 연결되는 컴퓨터, 라우터에는 공인 IP 주소
    - 회사, 가정의 랜에 있는 컴퓨터는 사설 IP 주소
    - DHCP(Dynamic Host Configuration Protocol)을 활용하여 사설 IP 주소를 할당
- IP주소는 2진수의 32비트를 동일하게 사용
    - MAC주소는 48비트, 16비트로 구분
    - IP주소는 32비트, 10진수로 표시
    - 각 8비트는 옥텟이라 부르고, 옥텟으로 구분

```txt
|11000000|10101000|00000001|00001010|
→ 192.168.1.0
```
- IP주소의 각 자리는 0부터 255까지
- IP주소는 네트워크ID와 호스트ID로 구분
    - 네트워크ID는 어떤 네트워크인지, 호스트ID는 해당 네트워크의 어떤 컴퓨터인지 나타냄

#### IP주소의 클래스 구조
- 네트워크ID나 호스트ID의 크기를 조정하여 네트워크 크기 조절할 수 있음
    - 네트워크 크기는 클래스 개념으로 구분
- A클래스 : 대규모 네트워크 주소
    - 8비트 네트워크ID, 24비트 호스트ID
- B클래스 : 중형 네트워크 주소
    - 16비트 네트워크ID, 16비트 호스트ID
- C클래스 : 소규모 네트워크 주소
    - 24비트 네트워크ID, 8비트 호스트ID
- D클래스 : 멀티캐스트 주소
- E클래스 : 연구 및 특수용도 주소

## 네트워크 주소와 브로드캐스트 주소의 구조
- 네트워크 주소는 호스트ID가 10진수 0, 브로드캐스트 주소는 호스트ID가 10진수 255
- 네트워크 주소는 전체 네트워크에서 작은 네트워크를 식별하는데 사용
- 브로드케스트 주소는 네트워크에 있는 컴퓨터나 장비 모두에게 한 번에 데이터를 전송하는데 사용

## 서브넷
- 많은 컴퓨터가 브로드캐스트 패킷을 전송하면 네트워크가 혼잡해짐
- 대규모 네트워크를 작은 네트워크로 분할하여 브로드캐스트로 전송되는 패킷의 범위를 좁힐 수 있고, 더 많은 네트워크를 만들 수 있어 IP주소를 효과적으로 사용할 수 있음
- 서브넷팅 : 네트워크를 분할하는 것
- 서브넷 : 분할된 네트워크
- 기존 네트워크ID, 호스트ID와 더불어 서브넷ID로 나누어짐
    - 기존 호스트ID를 구분하여 서브넷ID와 호스트ID로 나누어 사용

#### 서브넷 마스크
- IP주소를 서브네팅하면 호스트ID가 어디서부터 시작인지 판단하기 어려워짐
- 프리픽스(prefix) 표기법으로도 사용할 수 있음
    - 255.255.255.0/24

## 라우터의 구조
- 라우터는 네트워크를 분리하는 역할
- 스위치만 있는 네트워크에서는 모든 컴퓨터와 스위치가 동일한 네트워크에 속함
- 기본 게이트웨이 : 다른 네트워크에 접속한다면, 라우터의 IP주소 설정해야함

#### 라우팅
- 라우팅은 경로 정보를 기반으로 현재의 네트워크에서 다른 네트워크로 최적의 경로를 통해 데이터를 전송
    - 경로 정보가 등록되어 있는 라우팅 테이블
- 라우팅 테이블은 소규모 네트워크에서 수동으로, 대규모 네트워크에서 자동으로 할 수 있음
- 라우팅 프로토콜 : 라우팅 정보를 교환하기 위한 프로토콜
    - RIP, OSPF, BGP 등